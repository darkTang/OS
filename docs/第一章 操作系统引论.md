# 第一章 操作系统引论
## 1.1 操作系统的概念和功能
- 概念：
  - 负责管理协调硬件、软件等计算机资源的工作
  - 为上层用户、应用程序提供简单易用的服务
  - 是一种系统软件
- 功能：
  - 资源的管理者
    - 处理机管理
    - 存储器管理
    - 文件管理
    - 设备管理
  - 向上层提供服务
    - 普通用户
      - GUI用户图形界面
      - 命令接口
        - 联机命令接口（说一句做一句）
        - 脱机命令接口（说一堆做一堆）
    - 软件/程序员
      - 程序接口（系统调用）
  - 对硬件机器的扩展

## 1.2 操作系统的特征
并发和共享互为存在条件，它们是操作系统两个最基本特征。没有并发和共享就谈不上虚拟和异步。
- 并发
- 共享：资源共享
  - 同时共享
  - 互斥共享
- 虚拟：虚拟技术
  - 时分复用技术
  - 空分复用技术
- 异步

## 1.3 操作系统的发展和分类
- 手工操作阶段
  - 缺点
    - 用户独占全机
    - 人机速度矛盾导致资源利用率极低
- 单道批处理系统
  - 缺点
    - 内存中仅能有一道程序运行，资源利用率依然很低
- 多道批处理系统
  - 缺点
    - 没有人机交互功能
- 分时操作系统
  - 缺点
    - 不能优先处理紧急任务
- 实时操作系统
  - 硬实时系统：必须在严格的规定时间内完成处理
  - 软实时系统
- 网络操作系统
- 分布式操作系统
- 个人计算机操作系统

## 1.4 操作系统的运行机制
- CPU上运行的两类程序
  - 操作系统的内核程序
  - 应用程序
- CPU上的两类指令
  - 特权指令
  - 非特权指令
- CPU上的两种处理器状态
  - 内核态
  - 用户态
- 如何变态
  - 内核态 -> 用户态：执行一条特权指令，修改PSW的标志位为“用户态”
  - 用户态 -> 内核态：由“中断”引发，硬件自动完成变态的过程，此时会立即停止运行当前的应用程序，转而运行处理中断信号的内核程序

## 1.5 中断和异常
中断是让操作系统内核夺回CPU控制权的唯一途径。
- 中断类型
  - 内中断（异常）：与当前执行的指令有关，中断信号来源于CPU内部
    - 在用户态下执行特权指令
    - 执行的指令是非法的（如除以0）
    - 陷入指令（非特权指令）：应用程序主动将CPU控制权还给操作系统
  - 外中断（中断）：与当前执行的指令无关，中断信号来源于CPU外部
    - 时钟中断：实现并发机制
    - I/O中断
- 异常类型
  - 陷入、陷阱：陷入指令
  - 故障：内核程序可以修复，修复故障后重新将CPU控制权还给应用程序
  - 终止：内核程序无法修复，直接终止应用程序

## 1.6 系统调用
凡事与共享资源有关的操作（如存储分配、I/O操作、文件管理等），都必须通过系统调用的方式向操作系统内核提出服务请求，由操作系统代为完成。这样可以保证系统的稳定性和安全性。

## 1.7 操作系统的体系结构
- 大内核：linux、unix
  - 将操作系统的主要功能模块都作为系统内核，运行在核心态
  - 优点：高性能
  - 缺点：内核代码庞大，结构混乱，难以维护
- 微内核：windows NT
  - 只把最基本的功能保留在内核
  - 优点：内核功能少，结构清晰，方便维护
  - 缺点：需要频繁的在核心态和用户态之间切换，性能低
- 外核
  - 优点
    - 外核可以直接给用户进程分配“不虚拟、不抽象”的硬件资源，使用户进程可以更灵活的使用硬件资源
    - 减少了虚拟硬件资源的映射层，提升效率
  - 缺点 
    - 降低了系统的一致性
    - 使系统变得复杂

## 1.8 操作系统引导
- RAM（random access memory）：是一种用于临时存储和读写数据的存储器。RAM 具有快速的读写速度，可以频繁地读取和写入数据。它是计算机的主要工作内存，用于存储正在运行的程序、临时数据和操作结果。然而，RAM 是一种易失性存储器，即当计算机断电或重新启动时，RAM 中的数据会被清除。
- ROM（read-only memory）：是一种只能读取而无法写入的存储器。ROM 中的数据是在制造过程中被写入的，并且在计算机运行时保持不变。它存储了计算机的固件、引导程序和其他永久性数据。ROM 的内容无法被修改或擦除，因此它提供了一种稳定和可靠的存储方式。